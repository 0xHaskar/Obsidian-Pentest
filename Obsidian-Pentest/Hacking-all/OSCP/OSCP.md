<p align="center">
  <img width="300" height="300" src="https://raw.githubusercontent.com/0xsyr0/OSCP/a6b834ac1cfee81b38c13560e6018ce3a2f42809/images/kali-linux.svg">
</p>
## OSCP чек лист
---> https://github.com/0xsyr0/OSCP

---

<p align="center">
  <img width="300" height="300" src="https://raw.githubusercontent.com/Kitsun3Sec/Pentest-Cheat-Sheets/master/CheatSheets/28533648.png">
</p>
## Pentest-Cheat-Sheets
В этом репо собраны полезные скрипты и команды, которые помогут для пентеста! Это репо также поможет тем, кто пытается получить OSCP. Вы найдете множество способов сделать что-то без Metasploit Framework.
---> https://github.com/Kitsun3Sec/Pentest-Cheat-Sheets


---

## Стокгольмский синдром: тщательное сетевое тестирование
<p align="center">
  <img width="600" height="300" src="https://blog.exploit.org/content/images/size/w1200/2024/07/SZA00153.png">
</p>
При пентестировании сетей важна осторожность, важно выполнить анализ безопасности таким образом, чтобы не нарушить работу инфраструктуры заказчика. В этой статье я расскажу об аспектах, которые необходимо учитывать для надежного анализа безопасности.

[Above](https://www.kali.org/tools/above/) - Этот пакет содержит невидимый сниффер протоколов для поиска уязвимостей в сети, предназначенный для пентестеров и специалистов по безопасности.

| # Services Table      | Port                           | # Sniffing Table         | Multicast Address, Port, or EtherType |
| :-------------------- | :----------------------------- | ------------------------ | ------------------------------------- |
| `VNC`                 | `TCP/5900, TCP/5901, TCP/5902` | `CDP`                    | `01:00:0C:CC:CC:CC, SNAP: 0x2000`     |
| `RADIUS`              | `UDP/1812, UDP/1813`           | `DTP`                    | `01:00:0C:CC:CC:CC, SNAP: 0x2004`     |
| `TACACS+`             | `TCP/49`                       | `VTP`                    | `01:00:0C:CC:CC:CC, SNAP: 0x2003`     |
| `SSH`                 | `TCP/22`                       | `PVST`                   | `01:00:0C:CC:CC:CC, SNAP: 0x010B`     |
| `RDP`                 | `TCP/3389`                     | `LLDP`                   | `01:80:C2:00:00:0E`                   |
| `Cisco Smart Install` | `TCP/4786`                     | `EDP`                    | `00:E0:2B:00:00:00`                   |
| `WinRM`               | `TCP/5985`                     | `ESRP`                   | `00:E0:2B:00:00:02`                   |
| `Kerberos`            | `TCP/88, UDP/88`               | `MACSec`                 | `0x88E5`                              |
| `SMB`                 | `TCP/445`                      | `ARP`                    | `0x0806`                              |
| `HTTP`                | `TCP/80`                       | `802.1Q`                 | `0x8100`                              |
| `HTTPS`               | `TCP/443`                      | `802.1X`                 | `0x888E`                              |
| `RPC`                 | `TCP/135`                      | `STP`                    | `01:80:C2:00:00:00`                   |
| `SNMP`                | `UDP/161`                      | `OSPF`                   | `224.0.0.5`                           |
| `RTSP`                | `TCP/554`                      | `EIGRP`                  | `224.0.0.10`                          |
| `IPMI`                | `TCP/623, UDP/623`             | `HSRP`                   | `224.0.0.2, UDP/1985`                 |
| `SIP`                 | `TCP/5060, UDP/5060`           | `HSRPv2`                 | `224.0.0.102, UDP/1985`               |
| `FTP`                 | `TCP/21`                       | `GLBP`                   | `224.0.0.102, UDP/3222`               |
| `MySQL`               | `TCP/3306`                     | `VRRP`                   | `224.0.0.18`                          |
| `MSSQL`               | `TCP/1433`                     | `LLMNR`                  | `UDP/5355`                            |
| `PostgreSQL`          | `TCP/5432`                     | `NetBIOS (Name Service)` | `UDP/137`                             |
| `Zebra Routing`       | `TCP/2601`                     | `mDNS`                   | `UDP/5353`                            |
| `Winbox`              | `TCP/8291`                     | `DHCP`                   | `UDP/67, UDP/68`                      |
| `Winbox API`          | `TCP/8728`                     | `DHCPv6`                 | `UDP/546, UDP/547`                    |
| `Winbox API SSL`      | `TCP/8729`                     | `MNDP`                   | `UDP/5678`                            |
| `Telnet`              | `TCP/23`                       | `SSDP`                   | `UDP/1900`                            |
| `FINS`                | `TCP/9600, UDP/9600`           |                          |                                       |
| `CIP`                 | `TCP/44818, UDP/2222`          |                          |                                       |
| `ModbusTCP`           | `TCP/502`                      |                          |                                       |
| `S7Comm`              | `TCP/102`                      |                          |                                       |
| `LDAP`                | `TCP/389`                      |                          |                                       |
| `Syslog`              | `UDP/514`                      |                          |                                       |
| `TFTP`                | `UDP/69`                       |                          |                                       |
| `NFS`                 | `TCP/2049`                     |                          |                                       |
| `STUN`                | `UDP/3478`                     |                          |                                       |
| `NetBIOS`             | `TCP/137, TCP/138, TCP/139`    |                          |                                       |
| `OpenVPN`             | `TCP/1194, UDP/1194`           |                          |                                       |
| `Zabbix`              | `TCP/10050, TCP/10051`         |                          |                                       |
---> https://blog.exploit.org/caster-stockholm-syndrome/

---
# ЗАМЕТКИ! 
> [!Warning]
> Это просто мои заметки и не более!

[hash-identifier](https://www.kali.org/tools/hash-identifier/) - программа для определения различных типов хэшей, используемых для шифрования данных и особенно паролей.

# 5 Report Writing for Penetration Testers

> [!Note]
Несмотря на то, что результаты нашей оценки часто непредсказуемы, часто рекомендуется определить детальный объем работ во время предварительных встреч с заказчиком. Этот процесс особенно полезен при определении приоритетов критически важных для бизнеса целей в крупных сетях.

1. [CherryTree](https://www.kali.org/tools/cherrytree/)
2. [Obsidian](https://obsidian.md/)
3. LibreOffice
4. OnlyOffice
- Скриншоты являются важной частью создания заметок и технических отчетов. (Flameshot)
- https://excalidraw.com/ - это виртуальная доска для совместной работы, которая позволяет легко создавать эскизы диаграмм, напоминающие нарисованные от руки.

# 6 Information Gathering

Типичный тест на проникновение состоит из следующих этапов:
• Определение области применения
• Сбор информации
• Обнаружение уязвимостей
• Первоначальная точка опоры
• Повышение привилегий
• Горизонтальное перемещение
• Отчетность/Анализ
• Извлеченные уроки/Исправление
### **Пассивный сбор информации:**
• whois
• Google Hacking / [Google Hacking Database (GHDB)](https://www.exploit-db.com/google-hacking-database)
• [searchdns.netcraft.com](https://searchdns.netcraft.com/)
• [Gitleaks](https://www.kali.org/tools/gitleaks/)
• Shodan и аналоги

### **Активный сбор информации**

> [!Note]
Пожалуйста, обратите внимание, что сканирование портов не соответствует традиционным действиям пользователей и в некоторых юрисдикциях может считаться незаконным. Поэтому его не следует выполнять за пределами лабораторий без прямого письменного разрешения владельца целевой сети.

• nslookup
• host + [seclists](https://www.kali.org/tools/seclists/) (`sudo apt install seclists`) - `/usr/share/seclists`
• [dnsrecon](https://www.kali.org/tools/dnsrecon/) / [dnsenum](https://www.kali.org/tools/dnsenum/)

• [Nmap](https://www.kali.org/tools/nmap/)/ [masscan](https://www.kali.org/tools/masscan/)
> [!Note]
Системные администраторы могут изменять баннеры и намеренно указывать на поддельные названия сервисов, чтобы ввести в заблуждение потенциальных злоумышленников.

Чтобы просмотреть дополнительную информацию о скрипте, мы можем использовать опцию `--script-help`, которая отображает описание скрипта и т.д.  Nmap также предлагает множество полезных скриптов NSE, которые мы можем использовать для обнаружения и перечисления служб SMB.
```bash
ls -1 /usr/share/nmap/scripts/smb*
```

• [nbtscan](https://www.kali.org/tools/nbtscan/) - инструменты для конкретной идентификации информации NetBIOS.

**6.3.6 Перечисление SNMP**
> [!Note]
На протяжении многих лет мы часто сталкивались с тем, что многие сетевые администраторы плохо понимают простой протокол сетевого управления (SNMP). Это часто приводит к неправильной настройке SNMP, что может привести к значительным утечкам информации.

• [onesixtyone](https://www.kali.org/tools/onesixtyone/) - это простой SNMP-сканер, который отправляет SNMP-запросы на получение значения sysDescr асинхронно с настраиваемым пользователем временем отправки, а затем регистрирует ответы, в которых содержится описание программного обеспечения, запущенного на устройстве.

• Мы можем проверять и запрашивать значения SNMP с помощью такого инструмента, как [snmpwalk](https://www.kali.org/tools/net-snmp/#snmpwalk), при условии, что мы знаем строку сообщества SNMP, доступную только для чтения, которая в большинстве случаев является “общедоступной”.

# 7 Vulnerability Scanning

• Nessus

**7.3 Проверка уязвимостей с помощью Nmap**

> [!Note]
Скрипт NSE может иметь несколько категорий. Например, он может быть классифицирован как safe и vuln или как intrusive и vuln. Сценарии, отнесенные к категории “safe”, потенциально не влияют на стабильность, в то время как сценарии, отнесенные к категории “intrusive”, могут привести к сбою в работе целевой службы или системы.

Путь скриптов: `/usr/share/nmap/scripts/`
Главный файл: `script.db`
Для получения списка скриптов в категории vuln.
```bash
cat script.db | grep "\"vuln\""
```

Скрипт `vuln` в nmap:
```bash
sudo nmap -sV --script "vuln" 192.101.10.101
```
Сам скрипт имеет категории safe, vuln и external.

Поиск в поисковике скриптов NSE, например: `CVE-2024-***** nse`
Находим и скачиваем. 

Одним из первых результатов поиска является ссылка на страницу GitHub, которая предоставляет скрипт для проверки этой уязвимости. Давайте загрузим этот скрипт и сохраним его как `/usr/share/nmap/scripts/http-vuln-cve2024-****.nse`, чтобы соответствовать синтаксису именования других скриптов `NSE`. Прежде чем мы сможем использовать скрипт, нам нужно обновить `script.db` с помощью `--script-updatedb`.

Обновление списка скриптов:
```bash
sudo nmap --script-updatedb
```

> [!Error]
Мы также должны иметь в виду, что скрипт NSE может содержать вредоносный код, который предоставляет злоумышленнику полный доступ к нашей системе. По этой причине нам всегда необходимо проверять, что скрипт NSE не только обеспечивает необходимую функциональность, но и безопасен.

# 8 Introduction to Web Application Attacks

Захват баннера веб-сервера, мы уже знаем, что есть порт 80.
```bash
sudo nmap -p 80 -sV 192.101.10.10
```

Скрипт "http-enum" является частью Nmap Scripting Engine (NSE) и используется для обнаружения веб-серверов и каталогов на целевой системе. Он отправляет серию HTTP-запросов на указанный порт и анализирует ответы для идентификации программного обеспечения веб-сервера, каталогов и других веб-связанной информации.
```bash
sudo nmap -p 80 --script=http-enum 192.101.10.10
```


• [Wappalyzer](https://www.wappalyzer.com/) - это инструмент для определения технологий, используемых веб-сайтом.

• [Gobuster](https://www.kali.org/tools/gobuster/)- это инструмент, используемый для перебора URIs (каталогов и файлов) на веб-сайтах, DNS-поддоменов (с поддержкой шаблонов), имен виртуальных хостов на целевых веб-серверах, открытия пакетов Amazon S3, Google Cloud buckets и TFTP-серверов.

> [!Note]
Из-за своей грубой принудительной природы Gobuster может генерировать довольно большой трафик, а это означает, что он не будет полезен, когда необходимо оставаться незамеченным.

Gobuster поддерживает различные режимы перечисления, включая фаззинг и dns. Режим `dir`, который перечисляет файлы и каталоги.
```bash
gobuster dir -u 192.101.10.10 -w /usr/share/wordlists/dirb/common.txt -t
5
```

• [wordlists](https://www.kali.org/tools/wordlists/)- покажет пути для ворд листов! 
```bash
root@kali:~# wordlists -h

> wordlists ~ Contains the rockyou wordlist

/usr/share/wordlists
|-- amass -> /usr/share/amass/wordlists
|-- brutespray -> /usr/share/brutespray/wordlist
|-- dirb -> /usr/share/dirb/wordlists
|-- dirbuster -> /usr/share/dirbuster/wordlists
|-- dnsmap.txt -> /usr/share/dnsmap/wordlist_TLAs.txt
|-- fasttrack.txt -> /usr/share/set/src/fasttrack/wordlist.txt
|-- fern-wifi -> /usr/share/fern-wifi-cracker/extras/wordlists
|-- john.lst -> /usr/share/john/password.lst
|-- legion -> /usr/share/legion/wordlists
|-- metasploit -> /usr/share/metasploit-framework/data/wordlists
|-- nmap.lst -> /usr/share/nmap/nselib/data/passwords.lst
|-- rockyou.txt.gz
|-- seclists -> /usr/share/seclists
|-- sqlmap.txt -> /usr/share/sqlmap/data/txt/wordlist.txt
|-- wfuzz -> /usr/share/wfuzz/wordlist
`-- wifite.txt -> /usr/share/dict/wordlist-probable.txt
```

• [Burp Suite](https://www.kali.org/tools/burpsuite/) - Burp Suite - это интегрированная платформа для тестирования безопасности веб-приложений. Различные инструменты, входящие в состав Burp Suite, эффективно взаимодействуют друг с другом, поддерживая весь процесс тестирования, начиная с первоначального отображения и анализа уязвимостей приложения и заканчивая поиском и использованием уязвимостей в системе безопасности.

8.3 Перечисление веб-приложений

• Инструменты разработчика

**API**
За путями API часто следует номер версии, что приводит к такому шаблону, как:
```bash
/api_name/v1
```

• [Gobuster](https://www.kali.org/tools/gobuster/) (уже был выше)
Запуск:
```bash
gobuster dir -u http://101.101.10.10:8080 -w /usr/share/wordlists/dirb/big.txt -p pattern.txt
```

 Команда `gobuster` - это инструмент для brute-forcing каталогов и поддоменов на веб-серверах. Вот разбор команды, которую вы предоставили:
* `dir`: Это указывает, что мы хотим выполнить brute-force каталогов.
* `-u http://101.101.10.10:8080`: Это целевой URL, на котором будет проверяться доступность каталогов.
* `-w /usr/share/wordlists/dirb/big.txt`: Это файл со списком каталогов, который будет использован во время brute-force. В данном случае список каталогов находится в `/usr/share/wordlists/dirb/big.txt`.
* `-p pattern.txt`: Это указывает на файл пользовательской шаблонной строки для каталогов. Файл `pattern.txt` должен содержать список строк, которые будут добавлены к каталогам из списка.

```bash
pattern.txt 

{GOBUSTER}/v1
{GOBUSTER}/v2
```

В сущности, эта команда попытается обнаружить доступные каталоги на веб-сервере `http://101.101.10.10:8080` с помощью каталогов из файла `big.txt` и пользовательской шаблонной строки из `pattern.txt`. В нашем случае это попытка найти API.

> [!Note]
> Возможно!
> Если мы перейдем по пути /ui, то обнаружим всю документацию по API.

Проверим API /users с помощью curl.
```bash
curl -i http://101.101.10.10:8080/users/v1
Тут будет ответ и он может содержать информацию
```

Можем если, что-то найдем попытаться еще брутить:
```bash
gobuster dir -u http://101.101.10.10:8080/users/v1/admin/ -w
/usr/share/wordlists/dirb/small.txt
```
(пример с admin, т.к. есть шанс, что он будет или нет^-^)

• [JS Compress](https://jscompress.com/) - это бесплатный онлайн-инструмент, который позволяет сжимать код на JavaScript. Сжатие кода JavaScript может помочь уменьшить размер веб-страниц, что в свою очередь может помочь улучшить время загрузки вашего веб-сайта.
# 9 Common Web Application Attacks

• Directory Traversal
> [!Note]
Количество последовательностей `../` имеет значение только до тех пор, пока мы не доберемся до корневой файловой системы. Теоретически, мы можем добавить столько последовательностей `../`, сколько захотим, поскольку дальше возвращаться некуда. Это может быть полезно в определенных ситуациях, например, когда мы не знаем наш текущий рабочий каталог. В этом случае мы могли бы указать большое количество `../`, чтобы обеспечить доступ к корневой файловой системе с точки зрения относительного пути.

`/etc/passwd` - является текстовым файлом в операционных системах типа Unix, включая Linux. Он содержит информацию об учетных записях пользователей на системе.
`/.ssh/` - скрытая директория в операционных системах типа Unix, включая Linux, которая содержит файлы, связанные с протоколом Secure Shell (SSH).

Для обхода защит и т.д. можно использовать кодировку url и т.д.

> [!warning]
Браузеры часто пытаются проанализировать или оптимизировать элементы для удобства пользователя. При тестировании веб-приложений мы должны в основном использовать такие инструменты, как Burp, cURL.


9.2 Уязвимости, связанные с включением файлов

• Local File Inclusion (LFI)
> [!Note] 
> Уязвимости обхода каталогов для получения содержимого файла за пределами корневого каталога веб-сервера. Уязвимости, связанные с включением файлов, для запуска локальных или удаленных файлов, в то время как обход каталога позволяет нам только прочитать содержимое файла.

[Список полезных полезных нагрузок и обходных путей](https://github.com/swisskyrepo/PayloadsAllTheThings) для Web Application Security и Pentest/CTF `(Много полезной информации)`

• [Netcat](https://www.kali.org/tools/netcat/) - это универсальная сетевая утилита, используемая для чтения из и записи в сетевые соединения с использованием протоколов TCP или UDP. Ее часто называют "швейцарским ножом" сетевых инструментов из-за ее гибкости и широкого спектра возможностей.

• PHP Wrappers


