## Kerberos простыми словами
---> https://habr.com/ru/articles/803163/

---

## Kerberos для специалиста по тестированию на проникновение.  
  
• Cпециалисту по тестированию на проникновение инфраструктуры на базе Active Directory важно понимать общее устройство протокола Kerberos. Вот лишь несколько причин почему:  
- Знание устройства протокола Kerberos необходимо **для понимания ряда классических атак.**  
- Периодически появляются новые атаки, но прежде чем приступать к их эксплуатации, необходимо разобраться к каким последствиям они могут привести. Без знания Kerberos это порой затруднительно, либо вовсе невозможно.  
- Личная чуйка, что если человек называет себя специалистом, то он должен обладать несколько более глубокими знаниями, чем название инструмента или кнопки, на которую надо нажать.  

• В этом цикле статей автор попытался разобрать, как в теории устроен протокол Kerberos и какие атаки с его использованием можно осуществить на практике в Active Directory. Также будут приведены некоторые рекомендации по противодействию рассматриваемым атакам.  
  
• [**Часть 1. Теория:**](https://ardent101.github.io/posts/kerberos_theory/)  
- Требования к протоколу Kerberos;  
- Список терминов;  
- Аутентификация с использованием Kerberos;  
- Житейская аналогия;  
- По верхам в общем виде;  
- Разбор аутентификации в Kerberos согласно RFC;  
- Алгоритм формирования ключа;  
- Kerberos в Active Directory;  
- Доменная аутентификация пользователя к рабочей станции в Active Directory.  
  
• [**Часть 2. Классические атаки:**](https://ardent101.github.io/posts/kerberos_general_attacks/)  
- Атака на подбор имен пользователей;  
- Распыление пароля;  
- AS-REQ roasting;  
- AS-REP roasting;  
- Kerberoasting;  
- Pass-the-key / Overpass The Hash;  
- Pass-the-Ticket (PtT) / Pass-the-Cache;  
- PtT + AnySPN;  
- Silver Ticket;  
- Golden Ticket.  
  
• [**Часть 3. Неограниченное делегирование:**](https://ardent101.github.io/posts/kerberos_delegation/)  
- История и виды делегирования;  
- Устройство неограниченного делегирования;  
- Общая схема атаки при неограниченном делегировании;  
- Поиск учетных записей с неограниченным делегированием;  
- Атака “Извлечение из памяти сервера”;  
- Атака с использованием учетной записи без сервера;  
- Общая схема вариантов проведения атак;  
- Рекомендации.  
  
• [**Часть 4. Ограниченное делегирование:**](https://ardent101.github.io/posts/kerberos_constrained/)  
- Ограниченное делегирование с использованием только Kerberos (S4U2Proxy);  
- Ограниченное делегирование со сменой протокола (S4U2Self и S4U2Proxy);  
- Классическая атака на ограниченное делегирование;  
- Про другие атаки.  
  
**•** [**Часть 5. Делегирование, ограниченное на основе ресурсов:**](https://ardent101.github.io/posts/kerberos_rbcd/)  
- Устройство ограниченного на основе ресурсов делегирования;  
- Классическая атака на RBCD;  
- Как получить учетную запись с SPN;  
- Атака без контроля над учетной записью с SPN;  
- Изменение msDS-AllowedToActOnBehalfOfOtherIdentity с помощью ACL;  
- Изменение msDS-AllowedToActOnBehalfOfOtherIdentity через Relay-атаки.  
  
**•** [**Часть 6. PKINIT:**](https://ardent101.github.io/posts/shadow_creds/)  
- Криптография с открытым ключом;  
- Электронная цифровая подпись;  
- Центр сертификации;  
- PKINIT в Kerberos Active Directory;  
- Физическое хранение закрытых ключей;  
- NTLM в PKINIT;  
- Key Trust;  
- PassTheCertificate;  
- UnPAC the Hash;  
- Shadow Credentials;  
- Enterprises Key Admin.

---
